codes for figure 4
