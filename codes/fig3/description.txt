Codes for figure 3 and supplements
